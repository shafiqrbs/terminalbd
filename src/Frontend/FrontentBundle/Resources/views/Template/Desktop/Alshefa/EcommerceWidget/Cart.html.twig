
<div class="row-fluid">
    {% if app.user is empty %}
    <div class="login-area">
        <div class="modal-header" style="position: relative">
            <h5 class="modal-title">Sign up / Login </h5>
            <button type="button" class="close-btn btn btn-sm modal-close-btn btn-transparent" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span></button>
        </div>
        <div class="modal-body">
            <div id="cart-search">
                <form name="customerOtpLogin" method="post" action="{{ path(globalOption.subDomain ~ '_webservice_otp') }}"  id="customerOtpLogin" class="" novalidate="novalidate">
                    <div class="clearfix"></div>
                    <div class="" >
                        <div class="col-lg-12 col-xs-12 col-md-12 col-sm-12 col-sm-cus-12 text-center">
                            <h4 class="modal-title">Please Enter Your Mobile Number</h4>
                        </div>
                        <div class="clearfix"><br/></div>
                        <div class="col-lg-12 col-xs-12 col-md-12 col-sm-12 col-sm-cus-12">
                            <div class="input-group">
                                <div class="input-group-btn">
                                    <button type="button" class="btn btn-transparent" aria-label="Bold"><img src="{{ asset('assets/img/flags/bd.png') }}"></button></div>
                                <input type="text" class="form-control text-center input-number mobile" style="width: 100%" id="mobile" name="mobile" >            </div><!-- /.input-group -->
                            <span class="help-inline-otp">e.g 01710000000</span>
                        </div>
                        <div class="clearfix"><br/></div>
                        <div class="col-lg-12 col-xs-12 col-md-12 col-sm-12 col-sm-cus-12">
                            <div class="input-group">
                                <div class="input-group-btn text-center">
                                    <button type="submit" class="btn btn-warning "> SEND OTP CODE </button>
                                </div>
                            </div><!-- /.input-group -->
                        </div>
                    </div>
                    <div class="clearfix"></div>
                </form>
                <form name="customerOtp" method="post" action="{{ path(globalOption.subDomain ~ '_webservice_otp_confirm') }}"  id="customerOtp" class="" novalidate="novalidate">
                    <div class="clearfix"></div>
                    <div class="" >
                        <div class="col-lg-12 col-xs-12 col-md-12 col-sm-12 col-sm-cus-12 text-center">
                            <h4 class="modal-title">We've sent a 4-digit one time PIN in your mobile. <b id="sender-mobile"></b></h4>
                        </div>
                        <div class="clearfix"><br/></div>
                        <div class="col-lg-12 col-xs-12 col-md-12 col-sm-12 col-sm-cus-12">
                            <input type="text" class="form-control text-center" maxlength="4" id="otp" name="otp" placeholder="Please enter 4 digit on time pin code" >
                            <input type="hidden" id="otpCode" name="otpCode" value="">
                            <input type="hidden" id="resendMobile" name="resendMobile" value="">
                        </div>
                        <div class="clearfix"><br/></div>
                        <div class="col-lg-12 col-xs-12 col-md-12 col-sm-12 col-sm-cus-12">
                            <div class="text-center">
                                <button type="submit" class="btn btn-warning "> Submit </button>
                                <a href="javascript:" data-url="{{ path(globalOption.subDomain ~ '_webservice_otp') }}" data-content="" id="resendPin">Re-send Pin</a>
                            </div>
                        </div>
                    </div>
                    <div class="clearfix"></div>
                </form>
            </div>
        </div>
    </div>
    {% endif %}
    {% if app.user is not empty and app.user.profile.name is empty %}
    <div class="login-area">
        <div class="modal-header" style="position: relative">
            <h4 class="modal-title">Delivery Information</h4>
            <button type="button" class="close-btn btn btn-sm modal-close-btn" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span></button>
        </div>
        <div class="modal-body">
            <div id="cart-search">
                <form class="register" name="registerFormCreate" id="registerFormCreate" action="{{ path(globalOption.subDomain ~ '_webservice_ecommerce_customer_update') }}" method="post" novalidate="novalidate" style="display: block">
                    <div class="modal-body">
                        <div class="panel-body">
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon"><span class="glyphicon glyphicon-user"></span></span>
                                    <input type="text" id="registration_name" name="registration_name" required="required" class=" form-control" placeholder="Enter your full name" value="{{ app.user.profile.name }}">
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon"><span class="glyphicon glyphicon-phone"></span></span>
                                    <input type="text" id="registration_mobile" name="registration_mobile" required="required" class="form-control" placeholder="Enter your mobile no" value="{{ app.user }}" disabled="disabled">
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon"><span class="glyphicon glyphicon-phone"></span></span>
                                    <input type="text" id="registration_additional_phone" name="registration_additional_phone" required="required" class="form-control" placeholder="Enter your pickup mobile no" value="{{ app.user.profile.additionalPhone }}" >
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon"><span class="fa fa-map-marker"></span></span>
                                    <select id="registration_location" name="registration_location" class="form-control input-selector item-select" >
                                        {% for location in locations %}
                                            <option {% if app.user.profile.deliveryLocation is not empty and app.user.profile.deliveryLocation.id == location.id %} selected="selected" {% endif %} value="{{ location.id }}">{{ location.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <textarea id="address" name="registration_address" required="required" class="form-control" placeholder="Enter your address" >{{ app.user.profile.address }}</textarea>
                            </div>
                            <div class="checkbox"></div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <input type="hidden" name="token" value="{{ csrf_token('valid') }}"/>
                        <button type="submit"  class="btn btn-sm btn-blue pull-right" role="button">Confirm</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% if app.user is not empty and app.user.profile.name is not empty %}
<div class="row-fluid">
    <div class="col-xs-4 col-md-4">
        <div class="login-area">
            <div class="modal-header" style="position: relative; height: 52px">
                <h4 class="modal-title">Delivery Information</h4>
            </div>
            <div class="modal-body">
                <div id="cart-search">
                    <form class="register" name="registerFormUpdate" id="registerFormUpdate" action="{{ path(globalOption.subDomain ~ '_webservice_ecommerce_customer_update') }}" method="post" novalidate="novalidate" style="display: block">
                        <div class="panel-body">
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon"><span class="glyphicon glyphicon-user"></span></span>
                                    <input type="text" id="registration_name" name="registration_name" required="required" class=" form-control" placeholder="Enter your full name" value="{{ app.user.profile.name }}">
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon"><span class="glyphicon glyphicon-phone"></span></span>
                                    <input type="text" id="registration_additional_phone" name="registration_additional_phone" required="required" class="form-control" placeholder="Enter your pickup mobile no" value="{{ app.user.profile.additionalPhone }}" >
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon"><span class="fa fa-map-marker"></span></span>
                                    <select id="registration_location" name="registration_location" class="form-control input-selector item-select" >
                                        {% for location in locations %}
                                            <option {% if app.user.profile.deliveryLocation is not empty and app.user.profile.deliveryLocation.id == location.id %} selected="selected" {% endif %} value="{{ location.id }}">{{ location.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <textarea id="address" name="registration_address" required="required" class="form-control" placeholder="Enter your address" >{{ app.user.profile.address }}</textarea>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <div class="row-fluid">
                                <div class="col-xs-8 col-md-8"><span id="success-msg">Information Updated!</span></div>
                                <div class="col-xs-4 col-md-4">
                                    <input type="hidden" name="token" value="{{ csrf_token('valid') }}"/>
                                    <button type="submit"  class="btn btn-sm btn-info pull-right" role="button">Update</button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xs-8 col-md-8" id="prescription-content">
        <div class="col-xs-12 col-md-12">
            <div class="modal-header" style="height: 52px">
                <h4 class="modal-title">Checkout</h4>
                <a href="javascript:" class="close-btn btn btn-danger btn-sm" data-dismiss="modal" style="position: relative; float: right; top: -36px"><i class="glyphicon glyphicon-remove"></i></a>
            </div>

            {% if globalOption.ecommerceConfig.cartSearch == 1 %}
            <form name="stockItemForm" method="post" action="{{ path(globalOption.subDomain ~ '_webservice_stock_item_create') }}" enctype="multipart/form-data" id="stockItemForm" class="register" novalidate="novalidate">
                <div class="clearfix"></div>
                <div class="row" id="cart-search">
                    <div class="col-xs-6 col-md-6">
                        <input class="select2Stock form-control" autocomplete="off" name="itemName" id="itemName"  placeholder="Search your choose products..." style="border-radius:0!important;">
                        <input type="hidden" name="stockId" id="stockId">
                        <ul id="searchResult"></ul>
                        <span class="help-inline">Here you can add on demand products. Just typing a product name and click add button.</span>
                    </div>
                    <div class="col-xs-2 col-md-2" id="cart-subitem"></div>
                    <div class="col-xs-4 col-md-4">
                        <div class="input-group">
                            <div class="input-group-btn">
                                <button type="button" class="btn btn-transparent" aria-label="Bold"><strong class="currency" >{{ globalOption.ecommerceConfig.currency }}</strong><span id="salesPrice"></span></button></div>

                            <div class="input-group-btn">
                                <button type="button" class="btn  btn-number-stock text-center" data-type="minus" data-field="itemQuantity">
                                    <span class="glyphicon glyphicon-minus"></span>
                                </button>
                            </div>
                            <input type="text" class="form-control text-center input-number" style="width: 100%" value="1" min="1" max="1000"  id="itemQuantity" name="itemQuantity">
                            <div class="input-group-btn">
                                <button type="button" class="btn  btn-number-stock" data-type="plus" data-field="itemQuantity">
                                    <span class="glyphicon glyphicon-plus"></span>
                                </button>
                                <button type="button" id="unit" class="btn btn-unit">Unit</button> <button type="submit" class="btn btn-warning " id="stockSubmit" data-url="{{ path(globalOption.subDomain ~ '_webservice_stock_item_create') }}"><span class="glyphicon glyphicon-shopping-cart"></span> Add</button>
                            </div>
                        </div><!-- /.input-group -->
                    </div>
                </div>
                <div class="clearfix"></div>
            </form>
            {% endif %}
            <div class="clearfix"></div>
            <div>
                <form class="cart-form" id="cartForm" name="cartForm" action="{{ path('order_checkout',{'shop':globalOption.uniqueCode}) }}" method="post" enctype="multipart/form-data">
                    <div class="clearfix"></div>
                    {% if globalOption.ecommerceConfig.uploadFile == 1 %}
                    <div class="row">
                        <div class="col-xs-8 col-md-8">
                            <div style="height: 100px">
                                <input type="file" id="uploadFile" name="uploadFile" class="dropzone"/>
                            </div>
                        </div>
                        <div class="col-xs-4 col-md-4">
                            <textarea class="cart-comment" name="comment" id="comment" rows="5" style="width: 100%; padding: 7px; font-size: 12px" placeholder="Enter order related instruction"></textarea>
                        </div>
                    </div>
                    <div class="clearfix"><br/></div>
                    {% endif %}
                    <div id="stockCart">
                        <div class="row">
                            <div class="col-sm-12 col-md-12">
                                <div id="cart-item-list" style="width: 650px">

                                    <div id="stockCart">
                                        {% if  cart.contents is not empty %}
                                            <div class="top">Recent Buy Item's <span class="pull-right" style="margin-right:10px; margin-top:-2px" ><span class="btn btn-warning "><strong class="totalItem">{{ cart.contents|length }}</strong> | <strong class="cartQuantity">{{ cart.total_items }}</strong></span></span></div>
                                            <div id="cart-item-list-box">
                                                {% for product in cart.contents %}
                                                <div class="col-xs-12 col-md-12 list-group-item" id="item-remove-{{ product.rowid }}">
                                                    <div class="col-xs-3 col-md-3" data-match-height="item-product" style="display: flex;
    align-items: center;
    float: left!important;">  <a href="javascript:" id="{{ product.rowid }}"
                                      data-url="{{ path(globalOption.subDomain ~ '_webservice_product_cart_remove',{'cartid':product.rowid}) }}"  class="hunger-remove-cart" style="margin-right: 15px"> <span class="fa fa-remove"></span> </a>
                                                        {% if product.productImg is not empty %}
                                                            <img src="{{ image(product.productImg).scaleResize(80,80) }}" alt=""/>
                                                        {% else %}
                                                            <img style="height: 80px; width: 80px" src="{{ asset('assets/img/product-icon.png') }}">
                                                        {% endif %}
                                                    </div>
                                                    <div class="col-xs-10 col-md-10" data-match-height="item-product">
                                                        <div class="row">
                                                            <div class="col-xs-7 col-md-7 list-group-product">
                                                               {{ product.name }}<br>
                                                                {{ globalOption.ecommerceConfig.currency }} {{ product.price }} {% if product.productUnit is not empty %}/ {{ product.productUnit }} {% endif %}
                                                            </div>
                                                            <div class="col-xs-4 col-md-4 list-group-product">
                                                                <div class="input-group" style="width: 110px">
                                                                      <span class="input-group-btn input-group-btn-custom">
                                                                          <button type="button" class="btn btn-sm btn-transparent btn-danger btn-number-cart"
                                                                                  data-type="minus" data-field="quantity" data-id="{{ product.rowid }}"
                                                                                  id="btn-left-{{ product.rowid }}"
                                                                                  data-url="{{ path(globalOption.subDomain ~ '_webservice_product_medicine_cart_update',{'cartid': product.rowid}) }}" data-text="{{ product.id }}" data-title="{{ product.price }}">  <span class="fa fa-minus"></span>
                                                                          </button>
                                                                      </span>
                                                                    <input style="width: 50px;
    border: 1px solid #ddd;
    height: 30px;
    text-align: center;" type="text" readonly="readonly" name="quantity" id="quantity-{{ product.rowid }}"
                                                                           class="btn-number-cart" value="{{ product.quantity }}"
                                                                           min="1" max="100">
                                                                    <span class="input-group-btn">
                                    <button type="button" class="btn btn-transparent btn-sm btn-success btn-number-cart"
                                            data-type="plus" data-field="quantity"
                                            data-id="{{ product.rowid }}"
                                            data-url="{{ path(globalOption.subDomain ~ '_webservice_product_medicine_cart_update',{'cartid': product.rowid}) }}"
                                            data-text="{{ product.id }}" data-title="{{ product.price }}">
                                                      <span class="fa fa-plus"></span>
                                              </button>
              </span>
                                                                </div>

                                                            </div>
                                                            <div class="col-xs-1 col-md-1 list-group-product">
                                                                <div style="line-height: 30px">{{ globalOption.ecommerceConfig.currency }} <strong>{{ product.price|number_format(2) }}</strong></div>
                                                            </div>
                                                    </div>
                                                    </div>
                                                </div>
                                                {% endfor %}
                                            </div>
                                            <div class="bottom">
                                                <span class="dd-span pull-left">SubTotal:</span>
                                                <span class="dd-span pull-right"><strong>{{ globalOption.ecommerceConfig.currency }}
                                                        &nbsp;<span class="totalAmount">{{ cart.total|number_format(2) }}</span></strong></span>
                                            </div>
                                            <div class="bottom">
                                                <span class="dd-span pull-left">Delivery Day</span>
                                                <span class="dd-span pull-right"><input type="date" class="form-control" name="deliveryDate" id="deliveryDate"></span>
                                            </div>
                                            <div class="bottom">
                                                <span class="dd-span pull-left">Time Slot</span>
                                                <span class="dd-span pull-right">
                      <select id="timePeriod" name="timePeriod" class="form-control input-selector item-select" >
                           {% for period in timePeriods %}
                               <option value="{{ period.id }}">{{ period.name }}</option>
                           {% endfor %}
                       </select>
                     </span>
                                            </div>

                                        {% endif %}
                                    </div>
                                    {% if globalOption.ecommerceConfig.uploadFile == 1 %}
                                        <div>
                                            <table class="table">
                                                <tbody>
                                                <tr>
                                                    <td class="text-right">
                                                        <div style="height:100px;">
                                                            <input type="file" id="uploadFile" name="uploadFile" class="dropzone"/>
                                                        </div>
                                                        <p style="font-size: 11px; color: red; line-height: 20px; margin-bottom: 0">*JPG/GIF/PDF/PNG, less than 5MB</p>
                                                        <textarea name="comment" id="comment" rows="5" style="width: 100%; padding: 7px; font-size: 12px" placeholder="Enter order related instruction"></textarea>

                                                    </td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    {% endif %}

                                    {% if  cart.contents is not empty or globalOption.ecommerceConfig.uploadFile == 1 %}
                                        <div class="bottom" id="login-cart" style="margin-bottom: 15px">
                    <span class="dd-span pull-center" id="login-cart">
                    {% if app.user is empty %}
                        <a  href="#login-modal"
                            class="btn popup-top-anim btn-success"> Login & Place Order <span class="glyphicon glyphicon-play"></span></a>
                    {% else %}
                        <button  type="submit" class="btn btn-success">Place Order <span class="glyphicon glyphicon-play"></span></button>
                    {% endif %}
                    </span>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="clearfix"></div>

            <div class="clearfix"></div>
        </div>
    </div>
    <div class="clearfix"></div>
</div>
{% endif %}
<style>
    .modal-dialog , .product-modal-content{
        display: flex;
        align-items: center;
        justify-content: center;
    }
    #cart-search {
        background: #eeeeee;
        padding-top: 15px;
        margin-bottom: 15px;
        padding-bottom: 15px;
    }

    #customerOtp{
        display: none;
    }
    .login-area {
        width: 100%;
    }
    .modal-close-btn {
        position: absolute;
        right: 0;
        top: 15px!important;
        color: red!important;
    }
    .help-inline-otp {
        font-size: 12px;
        line-height: 12px;
        display: inline-block;
        padding-top: 3px;
        padding-bottom: 8px;
        text-align: center;
        width: 100%;
    }
    #success-msg{
        color: #009b3a;
        font-size: 11px;
        line-height: 28px;
        display: none;
    }
    .cart-quantity{
        width: 160px;
        display: inline-block;
    }

    #cart-item-list {
        border: 1px solid #f5f5f5;
        margin: 10px auto;
    }

    #cart-item-list #cart-item-list-box {
        overflow-y: auto;
        width: 100%;
    }

    #cart-item-list dl {
        border-bottom: 1px solid #f5f5f5;
        margin: 0 auto;
        overflow: hidden;
        padding: 10px;
    }

    #cart-item-list dt {
        font-weight: normal;
    }

    #cart-item-list dt img {
        border: 1px solid #fafafa;
        float: left;
        margin: 0 15px 0 0;
    }

    #cart-item-list dd {
        margin-top: 10px;
        overflow: auto;
    }

    #cart-item-list .bottom {
        background-color: #f5f5f5;
        color: #000;
        height: 40px;
        line-height: 40px;
        margin-top: 10px;
        overflow: auto;
        text-align: center;
    }

    /*
    #cart-item-list .top {
        background-color: #f5f5f5;
        height: 40px;
        overflow: auto;
        padding-left: 11px;
        text-align: left;
    }
    */

    #cart-item-list .dd-span {
        padding-left: 10px;
        padding-right: 10px;
    }

    #cart-item-list .dd-span-name {
        display: inline-block;
        width: 70%;
        text-align: left;
        height: 43px;
        overflow: hidden;
    }

    #cart-item-list .dd-span-action {
        display: inline-block;
        width: 13%;
        text-align: left;
    }

    #cart-item-list .dd-span-price {
        display: inline-block;
        width: 85%;
        text-align: right;
    }

    #cart-item-list p {
        padding-top: 5px;
        text-align: center;
        color: red;
        font-size: 12px;
    }

    #cart-item-list .dd-span-name {
        align-items: center;
        display: flex;
        width:90%;
        height: 75px;
        font-size: 12px;
        padding-right: 7px;
        float: left;
    }
    #cart-item-list .dd-span-remove {
        align-items: center;
        display: flex;
        height: 75px;
        font-size: 12px;
        padding-right: 7px;
    }
</style>
