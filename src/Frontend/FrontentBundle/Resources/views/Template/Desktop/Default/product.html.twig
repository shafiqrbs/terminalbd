{% extends ':template:base.html.twig' %}
{% block body %}
    <div class="clearfix"></div>
    <section id="breadcrumb">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="crumb">&nbsp;<a href="{{ path('homepage') }}">Home</a> <i>/</i>Products</div>
                </div>
            </div>

        </div>
    </section>
    <section>
        <div class="container" style="background: #464646">
            <div class="row-fuiid">
                <form method="get" action="" name="search">
                    <div class=" col-md-7" style="margin-top: 10px; margin-bottom: 10px">
                        {{ categoryTree|raw }}
                        <select class="select2" id="brand" name="brand" style="width:20%">
                            <option value="">Brand By</option>
                            {%  set brandId = app.request.query.get('brand') %}
                            {% for brand in brands  %}
                                <option {% if brand.id == brandId %} selected="selected" {% endif %} value="{{ brand.id }}">{{ brand.name }}</option>
                            {% endfor %}
                        </select>
                        <select class="select2" id="order" name="order" style="width:20%">
                            <option value="">Filter By</option>
                            {%  set order = app.request.query.get('order') %}
                            <option {% if order == 'ASC' %} selected="selected" {% endif %} value="ASC" >Lowest price</option>
                            <option {% if order == 'DESC' %} selected="selected" {% endif %} value="DESC">Highest price</option>
                        </select>

                        <button type="submit" class="btn btn-default glyphicon glyphicon-search" ></button>
                    </div>
                </form>
                <div class=" col-md-5 paginate">
                    <div class="pull-right"  >
                        {{ knp_pagination_render(products) }}
                    </div>
                    <div class="btn-group pull-right">
                        <a href="#" id="list" class="btn btn-default btn-sm page-button"><span class="glyphicon glyphicon-th-list"></span>&nbsp;List</a>
                        <a href="#" id="grid" class="btn btn-default btn-sm page-button"><span class="glyphicon glyphicon-th"></span>&nbsp;Grid</a>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section id="products">
        <div class="container">
            <div class="col-md-12">
                <div id="product" class="row list-group ">
                    {% for product in products %}
                        <div class="item  col-xs-{{ globalOption.ecommerceConfig.perColumn }}">
                            <div class="thumbnail js-equal-height" style="position: relative">
                               {% if product.discount is not empty %} <div class="offer-tag"><h6> {{ product.discount.name }}{% if product.discount.type == 'percentage' %} % {% endif %} <br> Off</h6></div>{% endif %}
                                {% if product.tag is not empty %}<div class="new-tag"><h6>{{ product.tag.name }}</h6></div>{% endif %}
                                <div class="product-preview group list-group-image "  >
                                    <img class="img-responsive" src="{{ image(product.webPath).scaleResize(400,400) }}" data-key="sameHeights" alt="">
                                    <div class="team-content" >
                                        <h5 class="team-prof">
                                            <a class="btn btn-sm blue preview"  data-url="{{ path('webservice_product_modal',{'subdomain': globalOption.subDomain,'item':product.id }) }}" >Preview<i class="fa fa-link"></i></a>
                                        </h5>
                                    </div>
                                </div>
                                <div class="caption product-caption">
                                    <p class="group inner list-group-item-heading"><a href="{{ path('webservice_product_details',{'subdomain': globalOption.subDomain,'item':product.slug }) }}">{% if product.masterItem is not empty %}{{ product.masterItem.name }}&nbsp;-&nbsp;{% endif %}{{ product.name }}</a> </p>
                                    <div class="row">
                                        <div class="row-fluid">
                                            <div class="col-xs-6 col-md-6"><strong class="currency">{{ globalOption.ecommerceConfig.currency }}</strong>&nbsp;<strike>{{ product.salesPrice|number_format }}</strike>&nbsp;<strong>{{ product.salesPrice|number_format }}</strong></div>
                                            <div class="col-xs-6 col-md-6 text-right"><strong>Stock in</strong>&nbsp;{{ product.quantity }}&nbsp;{% if  product.unit is not empty %}{{ product.unit.name }}{% endif %}</div>
                                        </div>
                                        <div class="row-fluid separator-margin" >
                                            <div class="col-xs-12 col-md-12  separator separator-absolute" >
                                                   {% if  globalOption.ecommerceConfig.cart == 1  %}
                                                       <span class="btn-add">
                                                        <i class="fa fa-shopping-cart"></i><a data-url="{{ path('webservice_product_details',{'subdomain': globalOption.subDomain,'item':product.slug }) }}" href="javascript:" class="hidden-sm">Cart</a>
                                                        </span>
                                                   {% endif %}

                                                <span class="btn-details">
                                                        <i class="fa fa-list"></i><a href="{{ path('webservice_product_details',{'subdomain': globalOption.subDomain,'item':product.slug }) }}" class="hidden-sm">More</a></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    {% endfor %}
                </div>
            </div>

        </div>
    </section>

    <section id="products">
        <div class="container">
            <div class="text-center"><h2>Feature Product</h2></div>
            <img class="img-responsive displayed" src="{{ asset('assets/template/desktop/patros/images/short.png') }}" alt="short" />
            <div class="text-right owl-carousel-next-prev">
                <div class="customNavigation" >
                    <a class="btn prev glyphicon glyphicon-chevron-left"></a>
                    <a class="btn next glyphicon glyphicon-chevron-right"></a>
                </div>
            </div>
            <div id="product" class="row">
                <div id="product-slider" class="owl-carousel">
                    {% for product in globalOption.inventoryConfig.purchaseVendorItems|slice(0,12)  %}
                        <div class="col-md-12">
                            <div class="thumbnail" data-key="sameHeights" style="position: relative" >
                                <div class="product-preview group list-group-image" >
                                    <img class="img-responsive" src="{{ image(product.webPath).scaleResize(400,400) }}" data-key="featureHeights" alt="">
                                    <div class="team-content">
                                        <h3 class="team-prof">
                                            <a class="preview"  data-url="{{ path('webservice_product_modal',{'subdomain': globalOption.subDomain,'item':product.id }) }}" >Preview</a>
                                            <small><strong>Stock in</strong>&nbsp;{{ product.quantity }}&nbsp;{% if  product.unit is not empty %}{{ product.unit.name }}{% endif %}</small>
                                        </h3>
                                    </div>
                                </div>
                                <div class="caption">
                                    <p class="group inner list-group-item-heading"><a href="{{ path('webservice_product_details',{'subdomain': globalOption.subDomain,'item':product.slug }) }}">{% if product.masterItem is not empty %}{{ product.masterItem.name }}&nbsp;-&nbsp;{% endif %}{{ product.name }}</a></p>
                                    <div class="row">
                                        <div class="row-fluid">
                                            <div class="col-md-12"><strong class="currency">{{ globalOption.ecommerceConfig.currency }}</strong>&nbsp;<strike>{{ product.salesPrice|number_format }}</strike>&nbsp;<strong>{{ product.salesPrice|number_format }}</strong></div>
                                        </div>
                                        <div class="row-fluid separator-margin" >
                                            <div class="col-xs-12 col-md-12  separator" >
                                                {% if  globalOption.ecommerceConfig.cart == 1  %}
                                                    <span class="btn-add">
                                                        <i class="fa fa-shopping-cart"></i><a data-url="{{ path('webservice_product_details',{'subdomain': globalOption.subDomain,'item':product.slug }) }}" href="javascript:" class="hidden-sm">Buy</a>
                                                    </span>
                                                {% endif %}
                                                    <span class="btn-details">
                                                        <i class="fa fa-list"></i><a href="{{ path('webservice_product_details',{'subdomain': globalOption.subDomain,'item':product.slug }) }}" class="hidden-sm">More</a></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>

            </div>
        </div>
    </section>
    <!-- Modal -->
    <div id="myModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content col-xs-12 col-md-12"></div>
        </div>
    </div>
{% endblock %}
{% block javascriptBlock %}
    {{ parent() }}
    {% javascripts
    '@FrontendBundle/Resources/public/js/jquery.matchHeight.js'
    '@FrontendBundle/Resources/public/template/js/product.js'
    '@FrontendBundle/Resources/public/template/js/common.js'
    %}
    <script type="text/javascript" src="{{ asset_url }}"></script>
    {% endjavascripts %}
{% endblock %}
{% block documentready %}
    {{ parent() }}
    ProductFeatureSlider({{ globalOption.ecommerceConfig.owlProductColumn }});
{% endblock %}