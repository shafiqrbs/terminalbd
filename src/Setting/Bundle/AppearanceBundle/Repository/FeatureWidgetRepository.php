<?php

namespace Setting\Bundle\AppearanceBundle\Repository;
use Doctrine\ORM\EntityRepository;

/**
 * FeatureWidgetRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class FeatureWidgetRepository extends EntityRepository
{
    public function setListOrdering($data)
    {

        $i = 1;
        $em = $this->_em;
        $qb = $em->createQueryBuilder();

        foreach ($data as $key => $value){
            $qb->update('SettingAppearanceBundle:FeatureWidget', 'mg')
                ->set('mg.sorting', $i)
                ->where('mg.id = :id')
                ->setParameter('id', $value)
                ->getQuery()
                ->execute();
            $i++;
        }


    }

    public function setDivOrdering($data)
    {

        $i = 1;
        $em = $this->_em;
        $qb = $em->createQueryBuilder();

        foreach ($data as $key => $value){

            $qb->update('SettingAppearanceBundle:FeatureWidgetItem', 'mg')
                ->set('mg.sorting', $i)
                ->where('mg.id = :id')
                ->setParameter('id', $value)
                ->getQuery()
                ->execute();
            $i++;

        }


    }

    public function setDivResize($data)
    {

        $em = $this->_em;
        $width = $data['width'];
        if($width > 100 || $width > 96 ){
            $width = 100;
        }
        $qb = $em->createQueryBuilder();
        $qb->update('SettingAppearanceBundle:FeatureWidgetItem', 'mg')
            ->set('mg.divWidth',$width)
            ->set('mg.divHeight', $data['height'])
            ->where('mg.id = :id')
            ->setParameter('id', $data['id'])
            ->getQuery()
            ->execute();
    }
}
